document.addEventListener("DOMContentLoaded", function () {
    let audio = document.getElementById("bg-music");

    let musicTime = localStorage.getItem("musicTime");
    if (musicTime !== null) {
        audio.currentTime = parseFloat(musicTime);
    }

    window.addEventListener("beforeunload", function () {
        localStorage.setItem("musicTime", audio.currentTime);
    });

    let playPromise = audio.play();
    if (playPromise !== undefined) {
        playPromise.then(() => {
            audio.muted = false; // Unmute setelah berhasil play
        }).catch(error => {
            console.warn("Autoplay diblokir, pengguna harus berinteraksi terlebih dahulu.");
        });
    }

    audio.onplay = function () {
        localStorage.setItem("musicPlaying", "true");
    };

    audio.onpause = function () {
        localStorage.setItem("musicPlaying", "false");
    };
});
